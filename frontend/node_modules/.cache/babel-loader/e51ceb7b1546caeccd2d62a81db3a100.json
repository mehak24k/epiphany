{"ast":null,"code":"import _defineProperty from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/Mehak/Desktop/epiphany/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import axios from'axios';import Form from'react-bootstrap/Form';import Button from'react-bootstrap/Button';import Col from'react-bootstrap/Col';import{Redirect}from\"react-router-dom\";import Row from'react-bootstrap/Row';import ButtonGroup from'react-bootstrap/ButtonGroup';import{TextField}from'@material-ui/core/';import{Autocomplete}from'@material-ui/lab/';import Alert from'react-bootstrap/Alert';import Spinner from'react-bootstrap/Spinner';var NewPost=/*#__PURE__*/function(_Component){_inherits(NewPost,_Component);var _super=_createSuper(NewPost);function NewPost(props){var _this;_classCallCheck(this,NewPost);_this=_super.call(this,props);_this.state={title:'',body:'',posted:false,tagsList:null,tags:null,newTags:null,errorMessage:''};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleSubmit=_this.handleSubmit.bind(_assertThisInitialized(_this));_this.addTag=_this.addTag.bind(_assertThisInitialized(_this));_this.deleteTag=_this.deleteTag.bind(_assertThisInitialized(_this));return _this;}_createClass(NewPost,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data,tags,tagArr,j;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('https://epiphany-test-three.herokuapp.com/main');case 2:data=_context.sent.data;console.log(data.data[0]);tags=data.data[1];tagArr=[];for(j in tags){tagArr.push(tags[j]);}this.setState({tagsList:tagArr});console.log(this.state.tagsList);case 9:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"handleChange\",value:function handleChange(event){this.setState(_defineProperty({},event.target.name,event.target.value));}},{key:\"deleteTag\",value:function deleteTag(event){console.log(event.target.id);var arr=[];if(this.state.tags===null){arr=[];}else{arr=this.state.tags;}var index=arr.indexOf(event.target.id);console.log(index);arr.splice(index,1);console.log(arr);this.setState({tags:arr});var arr2=[];if(this.state.newTags===null){arr2=[];}else{arr2=this.state.newTags;}if(arr2.indexOf(event.target.id)!==-1){arr2.splice(index,1);this.setState({newTags:arr2});}console.log(arr2);}},{key:\"addTag\",value:function addTag(event){this.setState({errorMessage:''});if(event.keyCode===13){if(this.state.tags!==null&&this.state.tags.some(function(tag){return tag.toLowerCase()===event.target.value.toLowerCase();})){this.setState({errorMessage:\"Tag has already been added.\"});}else{var arr=[];if(this.state.tags===null){arr=[];}else{arr=this.state.tags;}var tempArr=this.state.tagsList.map(function(value){return value.name.toLowerCase();});if(tempArr.indexOf(event.target.value.toLowerCase())!==-1){arr.push(this.state.tagsList[tempArr.indexOf(event.target.value.toLowerCase())].name);}else{arr.push(event.target.value);}this.setState({tags:arr});}console.log(this.state.tags);// this means the tag is new.\nif(this.state.tagsList.some(function(tag){return tag.name.toLowerCase()===event.target.value.toLowerCase();})){}else{var arr2=[];if(this.state.newTags===null){arr2=[];}else{arr2=this.state.newTags;}arr2.push(event.target.value);this.setState({newTags:arr2});}}}},{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var _this2=this;var postData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:postData={\"title\":this.state.title,\"body\":this.state.body,\"user\":localStorage.getItem(\"userEmail\"),\"tags\":this.state.tags,\"newTags\":this.state.newTags};console.log(postData);if(this.state.title===''||this.state.body===''||this.state.tags===null){this.setState({errorMessage:\"Please fill in all fields.\"});}else{axios.post('http://localhost:5000/create',postData).then(function(response){console.log(response);_this2.setState({posted:true});},function(error){console.log('Looks like there was a problem: \\n',error);});}event.preventDefault();case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"render\",value:function render(){var _this3=this;var top100Films=this.state.tagsList;var redirectTo=this.state.posted;if(redirectTo){return/*#__PURE__*/React.createElement(Redirect,{to:\"/\"});}return/*#__PURE__*/React.createElement(Col,{style:{paddingLeft:200,paddingRight:200}},this.state.tagsList===null&&/*#__PURE__*/React.createElement(\"div\",null,\" \",/*#__PURE__*/React.createElement(Spinner,{animation:\"border\",variant:\"primary\"}),\" \",/*#__PURE__*/React.createElement(\"p\",null,\"Loading...\")),this.state.errorMessage&&/*#__PURE__*/React.createElement(Alert,{variant:\"danger\"},\" \",this.state.errorMessage,\" \"),this.state.tagsList&&/*#__PURE__*/React.createElement(Form,{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(Form.Group,{controlId:\"formGroupTitle\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Title\"),/*#__PURE__*/React.createElement(Form.Control,{onKeyPress:function onKeyPress(e){e.key==='Enter'&&e.preventDefault();},type:\"text\",name:\"title\",placeholder:\"Enter title\",title:this.state.title,onChange:this.handleChange})),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(Row,{style:{paddingLeft:25}},this.state.tags&&this.state.tags.map(function(tag){return/*#__PURE__*/React.createElement(ButtonGroup,{style:{paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:5},\"aria-label\":\"Basic example\"},/*#__PURE__*/React.createElement(Button,{onClick:_this3.deleteTag,id:tag,variant:\"secondary\"},\"x\"),/*#__PURE__*/React.createElement(Button,{variant:\"secondary\"},tag));}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},this.state.tagsList&&/*#__PURE__*/React.createElement(\"div\",{style:{width:1125,paddingLeft:15}},/*#__PURE__*/React.createElement(Autocomplete,{id:\"free-solo-demo\",freeSolo:true,options:top100Films.map(function(option){return option.name;}),renderInput:function renderInput(params){return/*#__PURE__*/React.createElement(TextField,Object.assign({},params,{onKeyPress:function onKeyPress(e){e.key==='Enter'&&e.preventDefault();},id:\"standard-full-width\",label:\"Add tags!\",margin:\"normal\",variant:\"outlined\",onKeyUp:_this3.addTag}));}}))),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"formGroupPassword\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Body\"),/*#__PURE__*/React.createElement(Form.Control,{onKeyPress:function onKeyPress(e){e.key==='Enter'&&e.preventDefault();},as:\"textarea\",rows:\"15\",name:\"body\",placeholder:\"Body\",body:this.state.body,onChange:this.handleChange})),/*#__PURE__*/React.createElement(Button,{variant:\"success\",type:\"submit\"},\"Submit\")));}}]);return NewPost;}(Component);export default NewPost;","map":null,"metadata":{},"sourceType":"module"}